#include <QCoreApplication>
#include <QFile>
#include <QJsonObject>
#include <QJsonArray>
#include <QJsonValue>
#include <QJsonDocument>
#include <cmath>
#include <fstream>
#include <iostream>
#include <random>
#include "nlohmann/json.hpp"
#include <QTextStream>
#include <QDir>
#include <QtMath>

std::vector<int> vVMM = {0,1,4,5,6,7,14,15};
/*
std::vector<double> vADCOffsetCorrection = {12.595, 12.595, 14.588, 17.117, 14.290, 18.538, 22.422, 12.459, 15.393, 15.262, 19.850, 13.878, 21.647, 13.928, 19.519, 21.843, 22.800, 22.800, 16.741,
12.689, 22.508, 22.508, 14.187, 11.595, 11.227, 11.227, 17.193, 11.814, 11.814, 17.288, 13.797, 17.390, 17.261, 13.426, 21.110, 14.247, 13.812, 17.760, 14.977, 15.449, 14.292, 14.292, 19.945,
                                            19.945, 11.903, 11.903, 15.907, 19.490, 12.695, 16.338, 18.800, 17.440, 21.937, 23.343, 21.861, 28.859, 13.871, 17.049, 19.749, 18.922, 14.212, 21.432, 18.044, 17.541};

std::vector<double> vADCSlopeCorrection =  {1.023, 1.023, 1.029, 1.057, 1.044, 1.046, 1.016, 1.003, 0.988, 1.028, 0.995, 0.985, 0.935, 0.945, 0.983, 0.934, 0.936, 0.959, 0.938, 0.899, 0.903, 0.918, 0.888, 0.879, 0.897, 0.910, 0.886,
                                           0.896, 0.900, 0.930, 0.889, 0.920, 0.896, 0.888, 0.912, 0.843, 0.915, 0.878, 0.907, 0.939, 0.930, 0.884, 0.890, 0.888, 0.922, 0.937, 0.968, 0.926, 0.939, 0.939, 0.979,
                                           0.973, 0.996, 0.998, 0.994, 0.978, 1.025, 1.042, 1.063, 1.091, 1.111, 1.098, 1.124, 1.114};

*/
std::vector<double> vADCOffsetCorrection = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

std::vector<double> vADCSlopeCorrection = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};



std::vector<std::vector<double>> vOffsetCorrection = {
    {-41.4303,-37.7749,-36.9591,-36.1229,-36.573,-35.9322,-37.0151,-36.3192,-36.0362,-35.1325,-36.4007,-36.6067,-35.2303,-37.0761,-35.822,-33.8941,-35.3275,-35.0075,-36.3725,-34.7081,-34.0539,-40.4671,-35.1539,-38.4252,-37.4939,-37.4703,-37.1756,-43.1352,-36.5061,-43.8402,-42.5559,-40.1192,-39.3642,-41.5703,-40.44,-40.3051,-32.9172,-37.9348,-36.1128,-41.9582,-37.8959,-37.7532,-41.8435,-37.8729,-37.5628,-40.4866,-40.3978,-44.0771,-39.3153,-39.1119,-36.725,-40.2196,-40.2018,-38.4948,-41.663,-37.2987,-40.9012,-36.852,-37.1686,-39.1404,-38.9525,-39.7377,-42.1395,-40.4038},
    {-31.9083,-33.2671,-34.8843,-32.2479,-33.0987,-32.0002,-32.5267,-32.7799,-34.5387,-31.6815,-33.4646,-34.9263,-30.334,-30.6888,-32.7153,-30.3181,-33.0439,-35.2162,-33.1843,-32.5342,-33.5968,-33.5563,-30.7664,-35.7647,-35.5532,-32.6658,-34.6962,-35.5291,-36.8415,-33.9473,-34.9894,-40.4502,-36.6168,-34.5022,-34.9231,-33.8186,-36.2884,-35.3187,-39.1178,-39.9579,-35.4292,-35.7479,-36.24,-36.6086,-37.1472,-35.716,-35.9295,-35.067,-34.7944,-37.3976,-36.0801,-38.4832,-39.5492,-34.9236,-33.4512,-37.3728,-39.016,-39.8685,-38.0405,-36.9486,-34.0077,-38.4227,-32.845,-38.4421},
    {-28.2118,-31.2017,-28.1924,-27.7036,-30.2482,-27.2363,-27.9817,-30.1155,-28.3178,-25.8723,-30.8252,-29.4521,-24.4256,-26.6386,-27.4537,-22.2014,-30.4013,-30.0513,-24.5916,-28.2363,-29.1803,-27.5542,-25.0207,-26.7917,-30.2286,-27.6756,-26.7224,-29.7308,-28.0485,-30.4936,-23.703,-32.809,-31.6214,-31.4356,-32.5335,-32.3407,-29.8131,-30.5526,-42.0303,-33.2487,-35.9187,-33.1315,-31.2839,-33.5379,-30.1012,-33.0548,-31.8859,-34.8066,-32.8562,-36.512,-39.7582,-31.1296,-33.2073,-31.3755,-33.6569,-35.0801,-31.4695,-32.8359,-31.4482,-33.4609,-31.975,-35.5505,-33.4752,-36.9615},
    {-27.0292,-27.3011,-25.1665,-27.1646,-23.7669,-23.67,-26.4018,-22.471,-27.2056,-20.0312,-23.9063,-24.5998,-25.1722,-25.6747,-22.6057,-24.5666,-28.2177,-23.7026,-25.6532,-23.5265,-25.2784,-27.0019,-25.8596,-23.4264,-27.4781,-24.5336,-25.4148,-22.6502,-24.3717,-24.1616,-26.8488,-23.8664,-21.9013,-24.6573,-25.0554,-27.0516,-27.6476,-27.2952,-24.1752,-26.5468,-23.0651,-27.3163,-25.8819,-22.4754,-26.8201,0,-27.6098,-29.1256,-24.3541,-24.4146,-28.5058,-24.4483,-30.0787,-27.2876,-26.7348,-25.3679,-26.322,-24.9495,-24.7102,-24.0986,-27.1993,-27.618,-27.2261,-25.1303},
    {-20.6114,-18.8625,-16.4932,-12.323,-16.1037,-18.74,-16.6221,-14.0422,-14.6676,-17.4253,-15.695,-15.2076,-16.3239,-17.572,-15.5838,-12.3368,-18.3503,-18.3708,-16.4859,-12.7596,-9.76442,-12.9031,-12.4898,-16.8375,-17.8948,-12.0158,-13.8743,-15.8044,-13.6476,-11.3077,-16.0734,-10.2713,-15.2285,-15.2035,-13.9331,-16.3594,-15.4034,-12.5802,-13.0656,-10.6222,-13.3311,-16.3928,-11.4165,-16.0947,-16.2694,-15.6154,-18.2698,-15.3388,-12.9956,-15.6345,-16.1021,-12.8058,-15.7151,-16.3295,-17.6837,-15.2287,-17.7485,-15.3492,-15.8172,-15.2959,-17.1705,-15.2093,-14.6517,-16.0751},
    {-14.813,-17.4853,-12.1779,-15.7425,-14.6794,-19.7428,-11.2956,-14.3173,-10.255,-15.0949,-16.4605,-14.8393,-14.9514,-16.3031,-12.5589,-9.45439,-16.895,-15.976,-11.5189,-11.3434,-8.77079,-8.67051,-10.043,-15.6377,-12.9669,-14.8187,-10.7734,-14.653,-12.0164,-12.0312,-15.6499,-15.5671,-15.433,-7.90057,-15.9093,-14.4562,-14.737,-7.49769,-12.3611,-14.6546,-16.2354,-11.9783,-9.39188,-6.01899,-15.5965,-14.6698,-13.3003,-8.48142,-8.98477,-14.8663,-15.6802,-12.8316,-15.0121,-11.4824,-16.3691,-14.3065,-8.68077,-14.2509,-12.9456,-10.9004,-14.8982,-15.0735,-16.9038,-14.9116},
    {0,-13.6851,-12.2254,-11.6173,-12.0486,0,-11.8753,0,0,-10.761,-11.1036,-12.5646,0,-13.1715,-5.00106,-8.27592,0,-13.2822,0,-12.6977,-11.6628,-9.28044,-5.35855,0,0,-12.5253,-8.41942,0,0,-16.6696,0,-15.1525,-14.1982,0,-13.7203,-15.3262,-12.3326,0,-13.0694,0,0,0,0,-16.6695,0,0,-13.4144,-15.2772,-18.2138,-17.0886,-16.3079,-14.5284,-15.8709,-17.4731,-15.7485,-18.2337,0,0,0,0,0,0,0,-17.4575},
    {-27.7688,-22.9201,-22.8282,-23.4916,-24.3517,-24.2784,-22.772,-27.3757,-23.2218,-22.3585,-24.265,-24.3437,-24.2142,-24.6865,-23.6042,-24.2348,-23.558,-21.1452,-19.9418,-27.0803,-19.7907,-21.6136,-25.6235,-22.7376,-26.3122,-24.4527,-20.6589,-21.4688,-26.5228,-26.4174,-18.4115,-21.3641,-25.0206,-22.1698,-19.6333,-23.6559,-21.7862,-21.0069,-22.1875,-24.4882,-21.5336,-24.0383,-21.1907,-20.2154,-21.9297,-16.7906,-20.571,-19.7936,-19.3368,-18.1966,-20.9666,-18.5817,-21.4896,-18.3134,-21.0653,-21.4427,-18.9085,-17.3579,-18.48,-19.5748,-18.9974,-20.3687,-17.6504,-22.3978}
};


std::vector<std::vector<double>> vSlopeCorrection = {
    {0.965506,0.987885,0.98597,0.993279,0.9881,0.993238,0.989029,0.988835,0.989414,0.990491,0.987958,0.994217,0.98988,0.981744,0.992152,0.999695,0.989954,0.989735,0.991575,1.00425,1.01039,0.960774,0.991837,0.976392,0.983261,0.984661,0.984413,0.957221,0.99281,0.94731,0.968356,0.974003,0.985574,0.960532,0.986824,1.00679,1.00197,0.997258,0.99316,0.950219,0.992384,0.973065,0.958606,0.98731,1.00516,0.972333,0.964591,0.968312,0.999162,0.991177,0.99681,0.986457,0.976891,0.999437,0.965597,0.984145,0.971544,1.00178,1.00585,0.993351,1.00258,1.00787,0.962445,0.981752},
    {1.00638,1.00475,1.00592,1.00794,1.00294,1.09146,0.996975,1.0035,0.998224,1.00791,0.990954,0.994776,1.00688,1.00297,1.00827,0.999893,0.997504,0.998928,1.00023,1.00335,0.987788,1.00661,1.00018,0.981948,0.994115,0.99124,0.992832,0.982406,0.984153,0.999777,0.988512,0.960417,0.994825,0.99951,0.998039,0.988355,1.00016,0.999882,0.968178,0.970778,0.982373,0.986131,0.998584,0.985302,1.01332,0.991936,1.00536,1.01195,1.00814,0.981298,0.990124,0.989283,0.980737,1.00479,0.998605,0.977007,0.966392,0.984737,0.983767,0.991802,1.01089,0.993029,1.01076,0.978671},
    {1.00445,1.00624,1.00434,1.00582,0.998768,1.00261,1.00833,0.999305,1.00687,1.00765,1.00725,1.00499,1.00714,1.0065,1.00609,1.01952,1.00509,1.00005,1.02026,1.00956,1.00075,1.021,1.01496,1.0025,1.00568,1.01562,1.00136,1.00201,1.01739,0.99901,1.01358,0.997801,1.00326,1.01528,1.00143,1.00872,0.999714,1.01318,0.96701,1.01064,0.989695,0.99697,1.02286,1.00933,1.01349,1.01864,1.02853,1.01292,1.02097,0.995148,1.08109,1.02015,1.00962,1.00449,1.00234,0.978434,1.02449,1.00255,1.06057,1.00218,1.00553,1.00083,1.00562,0.994892},
    {1.01531,1.00279,1.02457,1.01428,1.01343,1.00849,1.00911,1.01894,1.00622,1.02362,1.00995,1.01288,1.01018,1.02201,1.0105,1.02674,1.00841,1.02096,1.02388,1.03219,1.01947,1.01402,1.0063,1.01781,1.01817,1.02842,1.0204,1.02912,1.01226,1.01222,1.01105,1.0185,1.02407,1.02285,1.03465,1.01061,1.01732,1.02513,1.03258,1.0096,1.02797,1.02059,1.01353,1.04382,1.00162,1,1.01985,1.00944,1.02247,1.02973,1.0142,1.02514,1.00652,1.02455,1.01683,1.0152,1.01066,1.02433,1.04704,1.0417,1.01824,1.01358,1.00732,1.01257},
    {1.00528,1.00222,1.00948,1.0444,1.01427,1.00176,1.00808,1.0196,1.01438,0.986417,0.998689,0.996697,1.00336,0.99874,0.998951,1.00541,0.995612,0.997828,1.00697,0.996196,1.04131,0.990166,1.00206,0.986567,0.995869,0.995185,0.983973,0.982708,0.994651,0.995507,0.984043,1.00314,0.99361,0.979034,0.997431,0.986599,0.987459,0.990357,0.994163,0.994756,0.989186,0.991953,0.994595,0.986141,0.982004,0.984272,0.997211,0.974699,0.984062,0.971621,0.987456,0.996336,0.98115,0.993267,0.994924,0.991238,0.995741,0.981168,0.982958,0.983523,0.997391,1.00799,1.02169,0.981607},
    {1.0279,1.02994,1.03352,1.01288,1.01845,1.007,1.02586,1.02571,1.05153,0.985311,1.0245,0.999638,1.00878,0.995262,0.992174,1.00146,0.994243,0.980922,1.00742,1.00752,1.03836,1.01873,1.02911,0.986019,1.00943,0.985075,1.0108,0.980203,0.999362,1.0033,0.973902,0.974438,0.983382,1.00557,0.981058,0.995526,0.984874,1.02568,0.992245,0.979531,0.982306,0.998244,0.998547,1.03694,0.986808,0.984275,0.983614,1.00548,1.00465,0.986933,0.973432,0.979994,0.983059,0.998264,0.994027,0.992206,1.01043,0.981606,0.981863,0.9994,0.982694,0.989499,0.992512,0.986523},
    {1,1.03148,1.0599,1.07529,1.06658,1,1.0545,1,1,0.995376,1.05525,1.02247,1,1.01587,1.06725,1.08253,1,1.01571,1,1.01862,1.03276,1.01024,1.07491,1,1,1.00103,1.0269,1,1,0.976804,1,0.997719,1.00862,1,1.00016,1.0006,1.01457,1,0.985236,1,1,1,1,0.992482,1,1,1.01266,1.00353,1.00295,0.9979,1.00753,1.04248,1.02906,1.03399,0.990683,1.01232,1,1,1,1,1,1,1,1.02533},
    {1.01321,1.03554,1.02963,1.02432,1.0289,1.01566,1.02372,1.02744,1.01687,1.01019,1.01361,1.01291,1.01663,1.011,1.00849,1.00777,1.00971,1.02055,1.02204,1.01174,1.01795,1.00896,1.01143,1.00847,1.00084,1.00552,0.993629,1.00796,1.01251,0.999731,1.00538,1.01365,1.00365,1.01099,1.01893,1.01518,1.00888,1.00639,1.03093,1.00542,1.006,1.01083,1.00616,1.00064,1.0128,1.01137,1.00462,1.00399,1.00111,1.00777,1.00193,1.00233,1.01421,1.02513,1.00641,1.01342,1.00644,1.02798,1.02293,1.01541,1.01866,1.01854,1.03636,1.02262}
};

/*
std::vector<std::vector<double>> vOffsetCorrection = {
    {-39.21,-36.1042,-35.0165,-35.2939,-35.4807,-35.54,-36.2458,-34.8345,-34.7624,-33.3957,-35.0201,-36.1532,-32.4099,-34.8234,-34.5924,-33.5444,-33.0637,-32.6271,-35.4871,-35.1017,-34.0248,-36.892,-33.3417,-36.0943,-36.0159,-35.8623,-36.0798,-39.9386,-36.0126,-40.1561,-40.5205,-37.961,-38.0317,-38.4708,-39.464,-40.5087,-33.5648,-38.12,-35.4103,-38.4212,-38.4822,-35.7722,-38.8787,-37.0437,-37.1834,-38.4218,-37.4807,-42.3237,-39.0701,-38.3464,-36.7441,-39.2533,-38.6065,-38.4911,-39.2794,-36.3129,-38.6208,-37.254,-37.9798,-38.3675,-38.78,-40.196,-39.7474,-39.0213},
    {-33.8571,-34.1653,-35.2416,-32.9215,-33.4409,-35.6774,-31.9013,-33.0739,-33.7097,-32.3291,-31.5485,-33.6072,-31.3018,-29.3424,-33.5158,-30.5149,-32.1642,-34.7878,-33.184,-32.6282,-31.333,-33.4897,-29.7342,-33.569,-34.9991,-30.997,-33.7756,-33.2519,-35.6834,-32.8971,-32.9243,-37.3637,-36.3385,-33.4092,-34.7188,-32.0384,-36.4386,-35.3728,-36.667,-37.7281,-33.417,-34.5541,-35.8374,-35.3686,-38.1239,-34.7674,-36.2964,-35.9566,-35.1656,-36.1345,-35.1138,-37.8332,-38.1688,-35.1618,-32.774,-35.3734,-36.987,-38.7131,-36.8807,-36.5393,-34.6956,-38.0908,-33.8351,-36.7926},
    {-30.299,-31.645,-29.485,-29.839,-30.7697,-28.2606,-30.5975,-30.6666,-30.0312,-26.4976,-29.9941,-29.511,-24.9507,-28.6052,-28.9506,-24.6229,-30.3307,-29.7593,-27.9892,-30.1696,-29.302,-30.7575,-26.9465,-27.2536,-31.1043,-29.5881,-27.4207,-29.1261,-29.6304,-29.3636,-25.757,-32.9319,-31.5004,-32.8351,-32.7587,-32.5805,-29.6081,-30.5056,-39.7763,-34.0815,-35.0582,-32.754,-31.9373,-34.5893,-30.9393,-34.9505,-33.6427,-36.1454,-34.9167,-36.373,-41.6863,-31.5811,-34.2764,-31.7614,-33.7264,-33.7618,-33.0919,-33.1932,-33.3648,-34.3516,-32.5247,-35.8096,-34.3958,-36.7905},
    {-29.8954,-28.4574,-27.7719,-30.2427,-25.5143,-24.9649,-28.8774,-24.8827,-28.9763,-22.2917,-26.032,-27.1688,-27.9047,-28.9878,-25.0094,-28.0644,-29.8374,-26.2746,-28.3382,-27.644,-28.0579,-29.1017,-26.9755,-26.242,-31.1339,-28.1831,-27.5193,-26.3037,-26.7772,-26.4668,-28.3116,-26.4658,-24.8318,-27.6623,-28.0629,-28.6314,-30.8712,-30.7787,-29.0514,-27.6543,-26.4538,-29.852,-28.3365,-26.9037,-27.5474,0,-30.2083,-30.359,-28.0875,-28.4473,-30.0362,-28.3467,-31.0448,-31.377,-29.5332,-28.2625,-27.7324,-28.7749,-28.3232,-28.4151,-30.5793,-30.7753,-29.187,-27.1533},
    {-22.6958,-21.6504,-19.0115,-13.1101,-18.0495,-20.7436,-18.9793,-16.6717,-17.2132,-18.6491,-17.6561,-16.5734,-19.1721,-19.6029,-17.6662,-13.5534,-20.9791,-20.6853,-19.0469,-14.5794,-12.4362,-15.3175,-13.6655,-18.9398,-19.9505,-12.7279,-15.0199,-18.6456,-16.2762,-12.0594,-19.4835,-12.5455,-17.4841,-17.4307,-16.8422,-19.5676,-16.712,-13.7698,-15.3616,-12.2819,-15.8112,-20.1989,-12.3197,-19.1134,-19.4033,-17.1904,-21.0861,-17.5761,-15.7703,-18.109,-19.349,-14.9792,-18.3333,-19.7765,-18.8069,-18.1785,-20.5256,-17.3513,-18.0748,-18.7647,-20.0728,-17.8216,-17.4779,-19.7238},
    {-16.5692,-19.1217,-14.4584,-18.2562,-16.6289,-23.5895,-11.8516,-17.3612,-12.7082,-18.3159,-19.5552,-17.915,-17.5783,-19.8233,-13.8398,-10.6961,-19.7087,-19.3026,-13.0598,-12.996,-9.56541,-9.82621,-13.0597,-18.6833,-16.3371,-17.8842,-13.0171,-17.9877,-14.2059,-14.3192,-18.3757,-18.1639,-18.7808,-9.4538,-18.5519,-18.3867,-18.0587,-9.46785,-14.4733,-17.6414,-19.6914,-14.4394,-9.87271,-9.61724,-18.6894,-17.3851,-16.3932,-9.95346,-9.91059,-18.307,-17.7605,-14.8387,-17.5252,-13.6528,-20.302,-18.1836,-9.95795,-17.3066,-15.5871,-13.1055,-18.3264,-18.6465,-19.6573,-18.5447},
    {0,-15.6176,-14.1785,-12.5746,-13.6653,0,-13.8557,0,0,-12.4353,-12.505,-13.5437,0,-15.0021,-7.72118,-8.9701,0,-15.78,0,-14.6349,-13.0547,-9.96317,-8.93309,0,0,-14.1424,-9.81534,0,0,-18.7706,0,-16.985,-16.0358,0,-15.8426,-18.0842,-13.6186,0,-14.7015,0,0,0,0,-17.7301,0,0,-15.357,-17.7595,-19.4484,-19.3168,-18.6708,-16.5333,-17.4835,-19.9699,-18.4419,-19.8111,0,0,0,0,0,0,0,-20.223},
    {-30.7332,-26.4775,-25.8701,-26.6894,-27.9403,-26.5987,-25.933,-30.2887,-25.5928,-24.865,-26.6747,-26.7454,-27.5963,-27.0616,-25.6686,-25.6943,-25.7889,-23.8221,-23.3915,-27.6106,-23.2366,-23.9687,-27.9134,-24.863,-26.3142,-25.8517,-21.7819,-23.5822,-28.461,-26.3551,-20.8841,-24.0131,-24.7957,-24.5348,-24.0143,-25.9909,-23.6077,-23.6807,-25.4628,-25.8646,-23.5908,-26.1681,-23.4097,-22.6532,-24.0862,-19.231,-23.2218,-22.512,-20.447,-21.1102,-23.2027,-20.543,-24.5158,-21.4028,-23.5274,-24.6374,-21.369,-20.1673,-21.0783,-22.386,-22.7738,-22.8747,-20.3023,-25.7948}
};


std::vector<std::vector<double>> vSlopeCorrection = {
    {1.06185,1.06004,1.06972,1.02896,1.03938,1.01519,1.02595,1.05379,1.04371,1.06599,1.04945,1.01702,1.11112,1.08434,1.04532,1.01625,1.08548,1.08894,1.03158,0.993287,1.00358,1.12972,1.06722,1.08241,1.05875,1.05979,1.03836,1.11011,1.02066,1.12406,1.06794,1.07694,1.04919,1.11352,1.04262,1.01171,0.980797,1.00593,1.02504,1.11583,0.992368,1.07039,1.10279,1.03508,1.0298,1.07024,1.103,1.04256,1.01863,1.03081,1.0064,1.036,1.04943,1.01079,1.08083,1.03294,1.0823,0.996014,0.983704,1.0372,1.0229,1.00393,1.07919,1.05679},
    {0.937696,0.971384,0.989625,0.981615,0.990303,0.936337,1.02341,0.992839,1.03153,0.984123,1.07335,1.04434,0.971031,1.05391,0.977178,0.993369,1.03341,1.01607,0.998961,0.999968,1.0901,1.00902,1.03933,1.07932,1.0195,1.06035,1.02603,1.07889,1.03779,1.03657,1.07627,1.11371,1.01164,1.03542,1.00332,1.06417,0.994131,1.00314,1.08923,1.07634,1.07379,1.04487,1.01849,1.04379,0.975669,1.03655,0.98912,0.976146,1.0037,1.04163,1.03211,1.02421,1.04407,0.996033,1.02889,1.06705,1.06516,1.0356,1.03637,1.00867,0.979999,1.00968,0.971462,1.05546},
    {0.933093,0.991834,0.959063,0.92646,0.980632,0.964553,0.91781,0.979556,0.945977,0.982049,1.0372,1.00351,0.98722,0.927788,0.949262,0.918579,1.01031,1.01313,0.892631,0.940699,0.997278,0.914312,0.940584,0.984564,0.973122,0.948048,0.974068,1.02837,0.958965,1.04452,0.92914,0.996872,1.01031,0.965855,0.995312,1.00262,1.00986,1.01596,1.08648,0.982653,1.02859,1.01519,1.00155,0.967732,0.982745,0.949596,0.962314,0.958388,0.944477,1.00491,1.0121,1.00614,0.972873,0.991794,0.99874,1.0469,0.964557,0.989494,0.957274,0.970641,0.986085,0.989703,0.974014,1.01114},
    {0.906594,0.95824,0.924502,0.897091,0.944187,0.955545,0.91306,0.921206,0.938185,0.927706,0.92132,0.915791,0.906382,0.892997,0.910729,0.891958,0.949982,0.916138,0.917118,0.86658,0.911082,0.932364,0.961461,0.900469,0.8835,0.884612,0.936755,0.880069,0.915333,0.91896,0.953091,0.912256,0.90393,0.904138,0.914901,0.948876,0.910286,0.895324,0.84314,0.964623,0.890009,0.924508,0.916184,0.865002,0.972411,1,0.93164,0.962464,0.876855,0.879195,0.956136,0.883199,0.970513,0.873231,0.907568,0.903016,0.952691,0.880817,0.904212,0.880755,0.890738,0.896525,0.930816,0.934349},
    {0.912308,0.882415,0.894879,1.01125,0.927469,0.914073,0.900667,0.885969,0.888314,0.926719,0.908172,0.930518,0.874089,0.90712,0.90354,0.942652,0.875735,0.888389,0.891191,0.905646,0.901192,0.873869,0.942847,0.887747,0.897589,0.955657,0.924002,0.855896,0.867122,0.956242,0.834151,0.883449,0.881176,0.867314,0.856918,0.843398,0.925527,0.927449,0.883665,0.904386,0.868854,0.826686,0.94473,0.850294,0.841927,0.907722,0.869013,0.872895,0.853785,0.860904,0.842246,0.889757,0.86273,0.839743,0.938993,0.857639,0.871328,0.887358,0.861793,0.831524,0.866812,0.869938,0.888887,0.822926},
    {0.945309,0.952832,0.917563,0.899786,0.924613,0.845634,0.999139,0.877335,0.923782,0.841431,0.887493,0.859155,0.876252,0.841028,0.90358,0.921985,0.86679,0.834672,0.918911,0.914058,0.985586,0.955947,0.873689,0.850205,0.848942,0.846357,0.89237,0.830973,0.885394,0.88844,0.852672,0.858221,0.821629,0.923125,0.841692,0.81823,0.836261,0.922256,0.888536,0.838075,0.831253,0.875287,0.951807,0.866362,0.828949,0.852517,0.840617,0.927953,0.94465,0.827905,0.877598,0.883263,0.865851,0.877954,0.823969,0.819153,0.94115,0.837938,0.856565,0.880904,0.832616,0.832188,0.866346,0.827459},
    {1,0.931652,0.954762,1.02181,0.979153,1,0.941743,1,1,0.904404,0.970434,0.971133,1,0.921477,0.930267,1.04411,1,0.891242,1,0.91777,0.944551,0.946748,0.896939,1,1,0.907508,0.944232,1,1,0.879545,1,0.909948,0.91515,1,0.894721,0.874596,0.943497,1,0.900222,1,1,1,1,0.941644,1,1,0.914763,0.872661,0.950334,0.897348,0.900792,0.942078,0.957582,0.919168,0.867247,0.937888,1,1,1,1,1,1,1,0.903554},
    {0.908294,0.890403,0.904565,0.894952,0.89502,0.923245,0.893682,0.928272,0.918043,0.904588,0.915583,0.913999,0.881859,0.916613,0.923142,0.94618,0.915688,0.907862,0.87567,0.989852,0.871193,0.909153,0.920895,0.91879,1.00156,0.947777,0.941384,0.915739,0.934313,1.00412,0.898328,0.90096,1.01289,0.912138,0.837036,0.914814,0.930232,0.889744,0.888591,0.947686,0.916549,0.920248,0.908172,0.893377,0.91902,0.901214,0.888234,0.886228,0.951008,0.88261,0.903077,0.916009,0.888853,0.890931,0.898559,0.880302,0.89891,0.904144,0.909273,0.894289,0.858648,0.911246,0.919149,0.882468}
};

*/
/*

std::vector<std::vector<double>> vOffsetCorrection = {
    {-26.0852,-20.524,-20.0839,-19.8459,-19.9521,-17.02,-19.6938,-18.5749,-19.2185,-17.0429,-16.4904,-17.8826,-17.1384,-19.2383,-18.3351,-14.557,-15.8904,-15.6864,-17.1068,-14.5378,-15.3022,-21.1086,-16.1992,-16.5194,-18.4781,-18.7388,-17.8899,-24.1259,-17.4893,-24.3284,-22.5795,-18.6651,-19.7603,-21.0563,-19.8481,-18.7941,-11.8433,-19.5318,-17.4335,-22.7893,-17.7205,-20.3367,-21.6229,-19.4531,-17.7543,-20.7132,-22.4422,-55.4936,-21.5084,-21.668,-19.7696,-22.0771,-21.7514,-19.4224,-20.6991,-20.4933,-21.1163,-21.2438,-21.2092,-20.522,-21.7053,-20.7676,-23.3639,-22.7294},
    {-11.7404,-11.205,-13.3431,-10.4058,-13.6334,-13.8531,-10.7381,-10.5401,-12.6108,-9.89591,-10.909,-13.3463,-8.30176,-9.75672,-10.0613,-8.88195,-9.16151,-12.9162,-10.4698,-10.1164,-11.0908,-11.463,-9.33041,-11.7324,-13.7145,-9.76954,-12.3339,-11.1786,-12.1792,-11.4995,-13.2098,-15.9334,-13.7855,-13.3131,-11.0016,-10.4731,-12.7783,-11.0651,-13.9177,-17.6368,-12.441,-12.5843,-13.3248,-10.3768,-13.4224,-10.3085,-10.98,-12.8962,-11.516,-13.9709,-15.2483,-15.2805,-16.2247,-12.8812,-11.4148,-13.6789,-16.8689,-17.2965,-15.8314,-15.0663,-14.1945,-17.9173,-12.2258,-17.6914},
    {-8.60284,-10.5625,-8.23231,-5.75594,-9.07908,-4.4242,-7.98622,-8.7039,-6.05618,-2.16437,-8.95038,-6.54755,-2.39819,-3.11321,-5.17229,1.94892,-8.44202,-6.89415,-1.46113,-5.01759,-6.03597,-5.04446,-0.60519,-2.77677,-6.30425,-4.63057,-4.74759,-5.5547,-4.25401,-6.24796,0.749466,-8.92845,-8.09645,-8.38928,-10.6917,-9.85292,-5.9528,-8.76142,-16.6048,-10.1461,-11.8376,-10.2127,-8.45521,-9.9349,-8.02728,-10.6607,-9.43303,-11.5237,-10.4523,-13.1454,-18.7728,-8.49657,-11.7567,-9.23466,-12.343,-11.4549,-6.32416,-12.1376,-12.6621,-13.0806,-10.3953,-15.3545,-12.0614,-17.8244},
    {-2.84217,-4.56581,0.00675304,-2.54375,1.28352,0.74387,-2.32366,2.21716,-2.46646,4.83303,0.0735543,0.404949,0.259227,-1.44715,2.39474,0.804729,-2.93209,1.12806,-0.422888,1.37419,0.00063837,0.962806,-2.08838,1.30717,-0.733421,0.552037,0.248876,1.42985,1.32414,3.86916,-2.62195,0.517737,2.24228,-0.537519,-1.68719,-3.3277,-0.474147,-2.5833,0.591086,-1.19323,1.31303,-2.70291,-1.57316,3.21307,-2.35009,0,-2.94493,-6.4302,0.0386332,0.299779,-5.06158,0.393483,-5.65182,-2.76107,-2.80321,-2.14065,-2.82805,-2.36126,-2.60864,-0.409743,-3.0601,-2.04202,-4.73768,-2.99863},
    {19.7907,23.7655,28.8864,30.7367,29.7718,25.9028,28.7986,34.1097,33.1963,27.073,29.7971,30.6585,28.9929,28.6244,30.9703,36.2627,27.8416,27.8421,29.4008,34.8515,36.8184,35.9875,34.9126,29.8033,28.4483,36.8015,33.1345,32.9453,33.1195,34.6255,31.4386,36.5664,33.2424,33.1772,33.4355,30.8973,31.5883,34.7939,36.2565,38.174,33.8625,31.3077,37.5951,30.7345,32.1892,28.9815,25.9865,32.5073,35.6864,32.0896,30.0485,34.2927,30.0633,29.6344,26.0926,34.207,27.0497,30.2178,32.5914,31.6592,26.5423,29.2732,29.0872,28.2047},
    {26.0145,27.9627,32.1248,25.9363,30.0704,22.0898,31.4623,31.6689,35.2461,32.3839,28.6303,32.515,29.884,27.627,34.5543,38.7508,27.2904,30.0911,36.2587,36.5971,37.1008,39.0169,37.3828,33.359,37.6189,32.9813,36.0578,36.5268,36.0145,38.3021,33.0581,33.23,35.981,38.6342,35.2961,33.361,34.1204,39.9664,35.3062,34.9285,30.8869,38.515,37.4158,42.3069,33.3321,31.2016,37.0542,38.9392,39.0473,33.2288,28.5133,33.6386,31.1656,36.525,27.938,32.6209,36.2992,32.6272,31.5552,34.2481,31.3076,28.8551,25.3541,29.9131},
    {13.86,13.858,14.3555,15.4997,15.9611,14.634,14.7369,14.2309,15.4054,16.0366,16.5605,16.8923,16.1545,14.657,24.0295,19.1269,15.2943,19.523,16.1456,17.8776,16.9008,20.6394,24.5714,19.7292,17.027,16.4396,22.0393,15.3891,15.7543,17.4888,15.0465,14.6686,16.2771,17.3283,13.7398,15.9581,18.3073,15.9322,16.0533,15.1068,22.2676,16.1197,14.184,10.5646,17.089,11.7921,16.3197,16.501,10.7529,14.9274,14.5672,15.8242,15.1045,14.4169,10.0421,10.6903,16.2073,17.8924,14.6008,14.2267,16.291,13.9315,11.6431,8.94948},
    {-2.62993,3.64686,2.33597,2.23394,1.45598,1.60021,2.93204,-0.749523,3.72645,3.84238,1.06929,3.11479,2.47111,2.17991,2.57552,0.931472,4.52681,4.61471,6.40424,-2.39006,8.59106,4.2454,3.03302,4.80491,0.331207,3.78802,5.22345,4.75925,2.50772,1.07672,11.7178,5.83589,2.59531,4.59289,12.1964,6.60908,4.80224,6.54497,5.70562,2.63763,5.17081,4.14951,5.53776,6.57017,3.52774,13.2841,7.44091,6.23331,6.53516,9.40995,5.23197,8.74009,4.41945,7.9457,5.56352,3.56892,6.14093,8.79379,6.47133,5.06266,5.8387,3.7428,6.82041,2.11703}
};


std::vector<std::vector<double>> vSlopeCorrection = {
    {1.00246,1.01192,1.01063,1.03031,1.01099,1.02291,1.004,1.02554,1.01863,1.02819,1.0244,1.05256,1.05677,1.04253,1.03958,1.02549,1.04312,1.05572,1.02231,1.01974,1.03218,1.06002,1.04197,1.05703,1.03567,1.03717,1.03866,1.11021,1.03216,1.09499,1.0762,1.07045,1.05044,1.08578,1.02359,1.01528,0.999744,1.01179,1.04148,1.09221,1.01893,1.0294,1.07744,1.01517,1.01377,1.05108,1.07202,1.03571,1.0115,1.01242,1.02289,1.01189,1.04818,0.993792,1.04493,1.02117,1.03791,1.01912,1.02125,1.00512,1.00882,1.00848,1.03674,1.01929},
    {0.993422,0.983909,0.983583,0.99514,0.999457,1.00365,1.00954,0.990068,1.01628,0.99069,1.06099,1.04948,0.981836,1.02434,0.989008,0.99932,1.01992,0.997414,1.00719,0.995863,1.04955,1.00162,1.01196,1.0445,1.0059,1.04469,1.05021,1.05298,1.02532,1.03368,1.06686,1.15221,1.02348,1.05643,1.00833,1.05321,0.991478,1.00564,1.11645,1.10777,1.04765,1.03095,1.03895,1.08258,0.965547,0.999077,1.00686,0.986754,0.980317,1.04289,1.0387,1.01803,1.0599,0.998512,1.01256,1.07401,1.04722,1.09488,1.01621,1.01878,0.998459,1.01603,0.969884,1.05153},
    {1.01285,1.01669,1.0266,1.01966,1.02203,1.00403,1.02273,1.02417,1.031,1.06024,1.03252,1.03777,1.01728,1.03593,1.01468,0.992083,1.05394,1.02804,1.01294,1.01814,1.02377,1.03239,1.01993,1.02124,1.02962,1.01349,1.00978,1.02527,1.00406,1.05673,1.00638,1.03416,1.01678,1.01808,1.03987,1.00069,1.05234,1.03424,1.10875,1.00288,1.06469,1.05873,1.00474,1.01936,1.02564,0.994455,1.00878,0.98173,0.988822,1.01479,1.10463,1.00695,0.998504,1.02019,1.02496,1.0502,0.985472,1.01497,0.967774,1.01783,1.01667,1.02061,1.00101,1.02792},
    {1.02502,1.00684,1.03264,0.99691,0.988643,1.00811,1.00888,0.989007,1.00857,0.942187,1.02033,1.01201,1.00158,1.01354,0.978007,0.972501,1.00037,0.988431,1.01468,0.968185,1.03672,0.971618,1.02221,0.993204,1.01956,0.964259,1.02007,0.986568,0.98857,0.943751,1.02621,1.01581,0.976152,1.02431,1.00836,1.02168,0.997114,0.994032,0.97745,1.00456,0.982108,0.983345,1.02331,0.928393,1.00937,1,1.01211,0.989277,1.02017,0.995491,1.00169,0.991008,0.989722,0.990894,0.996661,1.00614,1.00674,1.01367,1.00132,0.998958,1.00698,0.983586,0.985948,1.01858},
    {0.975733,0.998352,1.04544,1.00228,1.04427,1.04177,1.05631,1.1007,1.08917,1.051,1.05281,1.05318,1.0582,1.05942,1.06718,1.12318,1.07989,1.08626,1.06843,1.10843,1.09664,1.12384,1.10257,1.08921,1.09364,1.12208,1.07727,1.13279,1.08285,1.08395,1.1095,1.10909,1.09789,1.1055,1.09599,1.10937,1.08465,1.09851,1.13993,1.1356,1.10359,1.12312,1.1398,1.10101,1.13962,1.05098,1.05545,1.10536,1.12774,1.11551,1.09144,1.10154,1.07511,1.08512,1.05478,1.14284,1.05553,1.06824,1.09475,1.10275,1.04401,1.02453,1.02074,1.05865},
    {0.974203,1.01653,1.02965,0.981974,1.03883,1.0001,1.02469,1.04753,1.05657,1.10494,1.02896,1.08977,1.03421,1.03989,1.08207,1.13069,1.04662,1.07806,1.11518,1.11323,1.08487,1.13177,1.1119,1.12711,1.16314,1.09923,1.10516,1.1766,1.11918,1.16807,1.12384,1.12513,1.15002,1.11625,1.14416,1.09216,1.12757,1.1301,1.11724,1.14392,1.11177,1.18078,1.10704,1.1723,1.10105,1.06699,1.158,1.13677,1.14121,1.10259,1.0556,1.09723,1.07295,1.12176,1.049,1.08054,1.08386,1.0976,1.05423,1.07944,1.07856,1.0322,1.02334,1.04552},
    {0.870273,0.888579,0.879325,0.87117,0.853899,0.854502,0.86947,0.868515,0.881466,0.901955,0.853878,0.866389,0.86453,0.868018,0.865655,0.853434,0.900691,0.87362,0.866641,0.87284,0.85963,0.86318,0.858082,0.882195,0.863834,0.880719,0.885306,0.910322,0.893083,0.915921,0.908847,0.9052,0.883244,0.877674,0.90387,0.876837,0.883264,0.897095,0.903038,0.903224,0.905274,0.891082,0.892298,0.915169,0.882828,0.891745,0.873201,0.870329,0.906598,0.877826,0.88711,0.867538,0.877219,0.851572,0.886434,0.886268,0.864497,0.860923,0.864524,0.884815,0.858302,0.856281,0.882743,0.885262},
    {0.98411,0.928479,0.950843,0.943244,0.945156,0.967164,0.936033,0.979804,0.93331,0.923572,0.975568,0.929201,0.93282,0.948689,0.956457,0.994269,0.923443,0.922606,0.897381,1.00613,0.882774,0.933138,0.928858,0.930351,1.00255,0.942097,0.942281,0.931874,0.930736,0.987632,0.88846,0.90368,0.969308,0.910769,0.872058,0.905616,0.930176,0.905085,0.892044,0.953278,0.939338,0.917962,0.914049,0.910546,0.935663,0.885598,0.893633,0.902355,0.937878,0.88572,0.919777,0.911329,0.919569,0.884658,0.910387,0.927079,0.921269,0.887355,0.895606,0.918496,0.899119,0.930544,0.907805,0.945092}
};

/*
    std::vector<std::vector<double>> vOffsetCorrection = {
    {-27.0646,-21.2204,-20.9186,-20.5514,-20.5026,-17.6344,-20.1796,-19.5537,-19.9904,-17.7675,-17.2491,-18.2258,-18.0018,-19.9725,-19.5467,-14.9772,-16.9999,-16.8197,-17.678,-15.2376,-16.0088,-21.7543,-17.1229,-17.2446,-19.1565,-19.4817,-18.6491,-24.9838,-18.228,-25.2202,-23.1913,-19.392,-20.5933,-21.8941,-20.5252,-19.3376,-12.3434,-20.0816,-18.1365,-23.5762,-18.3147,-21.1917,-22.3404,-20.1096,-18.5461,-21.3712,-23.3313,-59.0849,-21.5991,-22.0445,-20.2212,-22.6842,-22.4865,-19.9687,-21.4619,-21.4247,-21.902,-21.5299,-21.382,-21.2719,-21.9311,-21.5185,-24.1707,-23.4581},

    {-11.5494,-10.9169,-13.1084,-10.1204,-13.3725,-13.4259,-10.2388,-10.1307,-12.4154,-9.63273,-10.7017,-12.8373,-7.53075,-9.09545,-9.6501,-8.29262,-8.51076,-12.6468,-10.109,-9.6386,-10.712,-10.9549,-8.6372,-11.4836,-13.3678,-9.49981,-12.0535,-10.707,-11.8205,-11.3942,-13.2395,-15.8072,-13.757,-13.2495,-10.8925,-10.1025,-12.7731,-11.0748,-13.7109,-17.8476,-12.4191,-12.3996,-13.3268,-10.2528,-13.3628,-10.2994,-10.813,-12.8156,-11.5035,-13.8436,-14.9954,-15.1098,-16.2385,-12.7956,-11.2807,-13.5915,-16.9653,-17.6343,-15.7476,-14.9347,-14.2264,-18.051,-12.1276,-17.8685},

    {-8.19645,-10.6928,-7.93037,-5.67989,-8.98148,-4.4423,-7.70373,-8.67572,-6.05508,-2.2231,-8.81215,-6.55354,-2.48699,-3.16212,-4.6567,1.95234,-8.43672,-6.74839,-1.52481,-5.02129,-5.99506,-4.99035,-0.281489,-2.74187,-6.15945,-4.61307,-5.05124,-5.54094,-4.21911,-6.29561,0.687087,-8.93855,-8.26613,-8.56257,-10.7207,-9.95191,-5.8835,-8.76804,-16.7455,-10.305,-11.815,-10.3705,-8.61544,-10.1046,-8.28365,-10.9488,-9.66132,-11.8574,-10.5299,-13.457,-18.8919,-8.58669,-11.9392,-9.16129,-12.5166,-11.6715,-6.37932,-12.328,-12.2505,-13.2518,-10.4482,-15.5189,-12.2998,-17.857},

    {-2.80029,-4.6582,0.0634609,-2.51165,1.38708,0.760857,-2.26183,2.20714,-2.51151,4.81015,0.150776,0.382313,0.406067,-1.27073,2.52199,0.808045,-2.96183,1.08926,-0.575123,1.27516,-0.367529,0.784912,-2.26347,1.27462,-0.870779,0.431772,0.184645,1.37819,1.23341,3.61449,-2.71351,0.496497,2.21746,-0.588463,-1.86233,-3.49748,-0.755935,-2.66606,0.507168,-1.41333,1.30804,-2.92153,-1.75605,3.13211,-2.33483,0,-2.98401,-6.4062,0.00699238,0.212661,-5.07735,0.398186,-5.69767,-2.80864,-2.91561,-2.18114,-2.86199,-2.52958,-2.65605,-0.708833,-3.11885,-2.30475,-4.85835,-2.8086},

    {19.0657,22.9823,28.1404,29.9013,29.0188,25.1432,28.1499,33.4226,32.4997,26.5293,29.1316,30.045,28.4729,28.0982,30.312,35.7043,27.2609,27.3017,28.7763,34.314,36.2684,35.4834,34.3544,29.2816,27.9013,36.3129,32.8125,32.3665,32.6622,34.0902,30.9482,36.0595,32.861,32.7942,32.8071,30.4737,31.3111,34.3825,35.9259,37.7865,33.4479,30.7908,37.3142,30.3203,31.7558,28.4009,25.3945,32.0752,35.1789,31.6433,29.6347,33.7296,29.5223,29.1126,25.6597,33.7898,26.415,29.6915,32.0688,30.7664,25.8324,28.6211,28.3747,27.523},

    {25.3448,27.2823,31.4075,25.3518,29.5688,21.5623,30.9957,31.2457,34.7321,32.085,28.072,32.0788,29.4654,27.158,34.2246,38.5555,27.0226,29.7885,35.9341,36.4506,36.6605,38.7904,36.9631,33.0527,37.1709,32.7734,35.7642,36.3384,35.7138,37.9863,32.8895,32.8953,35.709,38.1948,35.1756,32.9814,33.8051,39.5951,35.1388,34.789,30.6544,38.4936,37.2207,42.13,32.9172,30.92,36.7592,38.6651,38.9312,33.0901,28.2659,33.2115,30.802,36.1577,27.413,32.3571,35.9341,32.239,31.2391,33.9146,30.9797,28.4137,25.0738,29.078},

    {0,14.0565,14.9473,15.8271,16.2306,0,15.1149,0,0,16.3838,17.1534,17.3593,0,15.357,24.8845,19.7195,0,20.4051,0,18.8288,17.5753,21.643,25.5528,0,0,17.2579,22.686,0,0,18.4256,0,15.3367,16.8386,0,14.3822,16.7164,18.945,0,16.738,0,0,0,0,11.2268,0,0,16.7402,16.9903,11.0814,15.4857,14.8912,16.2014,15.3596,14.5219,10.1712,10.8269,0,0,0,0,0,0,0,8.67563},

    {-2.77362,3.406,2.27474,2.32182,1.3951,1.51871,2.82949,-0.781159,3.54334,3.72318,1.01057,2.88062,2.32472,1.99971,2.57975,0.77933,4.25737,4.41235,6.19498,-2.55401,8.36724,4.06167,2.85401,4.586,0.236813,3.64915,5.0445,4.67625,2.29496,0.887473,11.3105,5.50912,2.46045,4.35078,11.5135,6.29787,4.58174,6.23307,5.42331,2.46426,5.06602,3.91676,5.3047,6.40789,3.48804,13.0399,7.14437,6.26818,6.60118,9.21974,5.24679,8.62394,4.42186,7.96796,5.51242,3.65842,6.14598,8.80511,6.83552,5.11697,5.87764,3.94157,6.82449,2.20281}
};


std::vector<std::vector<double>> vSlopeCorrection = {
    {0.982462,1.00566,0.99489,1.02309,1.00492,1.01945,1.00499,1.01098,1.0084,1.01983,1.016,1.05945,1.03491,1.0273,1.02122,1.02848,1.02253,1.02999,1.01895,1.01505,1.03306,1.04437,1.02708,1.05174,1.03203,1.03161,1.03109,1.09492,1.02752,1.07986,1.06766,1.06644,1.04092,1.074,1.02772,1.01868,1.00642,1.01576,1.03524,1.08026,1.02343,1.02416,1.06971,1.01094,1.01272,1.04133,1.04976,0.944164,1.01087,1.01193,1.03256,1.00593,1.03525,0.996114,1.03637,1.01372,1.02734,1.02073,1.02546,1.00476,1.01639,1.01638,1.02262,1.01353},
    {0.993505,0.988058,0.983332,1.00163,0.999458,1.00561,1.01207,0.992538,1.02124,0.987454,1.06043,1.04823,0.98733,1.03189,0.995149,1.0066,1.02826,1.00357,1.01475,1.00255,1.06051,1.01289,1.02363,1.05219,1.00859,1.04923,1.0574,1.06286,1.03202,1.04147,1.07035,1.16541,1.03315,1.05879,1.0105,1.06136,0.996217,1.01276,1.12792,1.11022,1.05812,1.03662,1.04513,1.09146,0.963923,0.999449,1.01,0.990356,0.982509,1.04589,1.04621,1.02681,1.05921,1.00565,1.01678,1.07756,1.04944,1.09404,1.01747,1.02118,1.00057,1.01243,0.97613,1.04776},
    {1.01251,1.0201,1.02783,1.02734,1.03262,1.00291,1.02605,1.03155,1.0317,1.06592,1.03308,1.04095,1.02087,1.03933,1.01849,0.992653,1.04565,1.03311,1.00952,1.01593,1.02393,1.03259,1.01903,1.02146,1.03863,1.01119,1.01279,1.01957,1.00539,1.05507,1.00656,1.04752,1.02164,1.0232,1.04884,1.00619,1.06178,1.04122,1.11172,1.00305,1.07039,1.06568,1.01095,1.02532,1.02678,0.998168,1.01372,0.982612,0.992411,1.00842,1.11996,1.00807,1.00062,1.02909,1.02908,1.05003,0.989347,1.01767,0.981796,1.02409,1.02041,1.0229,1.00338,1.03355},
    {1.03692,1.01218,1.05268,1.00248,0.998552,1.01368,1.01889,0.995501,1.01512,0.939908,1.02975,1.01977,1.00352,1.02921,0.983595,0.969172,1.00161,0.992841,1.01415,0.975955,1.03591,0.970922,1.02698,1.00117,1.02393,0.968311,1.02631,0.993139,0.992138,0.938578,1.03642,1.02793,0.984794,1.03089,1.01472,1.02987,0.99257,1.00035,0.986709,1.00603,0.991535,0.986011,1.02674,0.926412,1.01441,1,1.02228,1.00179,1.03431,1.0034,1.01119,0.999648,0.996734,0.997257,1.0033,1.01425,1.01692,1.0229,1.01182,1.00398,1.01814,0.983206,0.987594,1.02128},
    {0.951087,0.96729,1.01815,0.96572,1.01271,1.01532,1.03221,1.07195,1.06153,1.0348,1.02523,1.03025,1.03957,1.04305,1.04133,1.10165,1.05945,1.07406,1.04571,1.09497,1.07134,1.11256,1.08172,1.07759,1.08362,1.11057,1.07973,1.11417,1.0682,1.06451,1.09266,1.08928,1.08453,1.09292,1.07253,1.09974,1.08403,1.09075,1.13123,1.12978,1.09281,1.10664,1.13876,1.09123,1.13501,1.03187,1.03171,1.09274,1.10536,1.10022,1.07775,1.07949,1.05327,1.06586,1.04436,1.13056,1.03112,1.04804,1.07833,1.06492,1.01537,0.997373,0.986363,1.03303},
    {0.942331,0.980676,0.99281,0.949858,1.01198,0.974056,1.00099,1.02018,1.02256,1.08677,0.992405,1.0667,1.00589,1.01164,1.0641,1.11884,1.02902,1.05898,1.0959,1.10319,1.05474,1.11639,1.08252,1.11175,1.13726,1.08656,1.08647,1.17079,1.10274,1.15406,1.11555,1.11126,1.13864,1.09704,1.14002,1.06768,1.11059,1.11279,1.10459,1.13817,1.1037,1.17734,1.0905,1.16646,1.07685,1.04896,1.14378,1.12321,1.13406,1.08764,1.04139,1.07572,1.05419,1.10098,1.01865,1.05531,1.0609,1.07474,1.03433,1.05907,1.05374,1.00394,1.00286,1.00535},
    {1,0.877602,0.863291,0.856868,0.834459,1,0.854316,1,1,0.889064,0.83585,0.848908,1,0.851938,0.848507,0.834781,1,0.855662,1,0.860317,0.841099,0.851966,0.841467,1,1,0.866182,0.872766,1,1,0.907069,1,0.893931,0.865463,1,0.892551,0.859885,0.866316,1,0.891782,1,1,1,1,0.905627,1,1,0.857228,0.852464,0.89331,0.860192,0.866782,0.847085,0.857444,0.82802,0.869775,0.870206,1,1,1,1,1,1,1,0.873696},
    {0.987448,0.924196,0.95344,0.943067,0.945756,0.969284,0.936131,0.984627,0.928024,0.918182,0.980462,0.925491,0.931195,0.951553,0.959291,0.99955,0.915134,0.920432,0.889751,1.01277,0.868656,0.932201,0.918925,0.92431,1.0044,0.934787,0.942175,0.930809,0.92484,0.987617,0.869569,0.893551,0.972352,0.904946,0.846378,0.888517,0.924168,0.893397,0.874994,0.955661,0.936847,0.907158,0.905882,0.903268,0.931667,0.863136,0.878185,0.893144,0.931966,0.868495,0.910898,0.898369,0.908921,0.871781,0.896394,0.91759,0.913657,0.873283,0.881687,0.91345,0.889265,0.926123,0.891369,0.941634}
};


std::vector<std::vector<double>> vOffsetCorrection = {
    {-25.592,-20.0164,-19.1758,-19.7612,-19.5234,-16.8229,-19.3346,-17.5947,-18.4776,-17.0164,-15.4849,-17.1556,-16.9653,-18.1747,-17.4351,-14.1069,-15.6752,-15.4559,-16.4692,-13.9095,-15.0834,-19.7689,-15.8768,-15.3376,-17.3435,-17.284,-17.0074,-22.2921,-16.9054,-22.5229,-20.8906,-16.3208,-18.5338,-19.5233,-18.4957,-17.6208,-11.1337,-18.5678,-16.4536,-21.553,-16.544,-19.3308,-19.7407,-18.4287,-16.6303,-19.4016,-20.624,-60.0577,-19.8996,-20.3925,-18.9196,-20.7618,-20.0933,-18.3105,-19.4004,-19.8261,-19.7818,-20.3788,-20.2141,-19.3609,-21.026,-19.5205,-21.3789,-21.5981},
    {-10.7063,-9.62994,-11.7502,-9.02479,-12.4605,-12.1185,-9.25186,-8.97786,-11.0309,-8.28253,-9.25092,-11.5465,-6.45958,-7.93704,-8.1709,-7.17869,-6.86449,-10.9892,-8.67462,-8.24669,-9.3459,-9.56248,-7.3803,-9.82031,-11.7434,-8.2628,-10.2263,-9.20735,-9.95408,-9.78792,-11.8986,-14.5655,-11.9356,-11.9074,-8.96325,-8.52231,-10.8108,-9.07885,-12.3044,-16.0098,-10.394,-10.6443,-11.8322,-8.67135,-11.383,-8.32671,-9.02614,-10.9674,-9.66816,-12.1208,-13.4718,-13.3453,-14.552,-11.0796,-9.63636,-11.9416,-15.5192,-16.2052,-13.6642,-13.1516,-12.8142,-16.2708,-10.6546,-16.3658},

{-8.08842,-11.5946,-7.898,-6.12598,-9.88845,-5.02884,-7.76089,-9.1443,-6.84458,-2.40676,-9.18018,-7.28002,-2.7673,-3.7206,-4.4285,1.69592,-8.86191,-7.46027,-1.70764,-5.46466,-6.71931,-5.58798,0.058294,-3.02061,-6.99034,-5.1241,-4.98605,-6.02444,-4.74203,-6.98357,0.521138,-9.88156,-8.96139,-9.22017,-11.7207,-10.6756,-6.99943,-9.33531,-17.6707,-11.0575,-12.4905,-11.2673,-9.30009,-10.8529,-8.90249,-11.7408,-10.4022,-12.8069,-11.4742,-14.1853,-20.3427,-9.18855,-12.8099,-10.1479,-13.2762,-12.4235,-7.18813,-13.0589,-12.5575,-14.2823,-11.2425,-16.4087,-12.9097,-18.8805},
    {-3.00311,-5.26255,-0.100481,-2.87203,0.989014,0.472945,-2.76515,1.8475,-2.80613,4.42723,-0.0180614,0.182734,0.188587,-1.78496,2.12463,0.575806,-3.37202,0.826117,-0.935436,0.942134,-0.782612,0.508478,-2.67336,0.909765,-1.34622,0.239383,0.0464156,1.11411,0.941858,3.27883,-3.00913,0.27386,1.84815,-1.15345,-2.3058,-4.24965,-1.22023,-3.02332,0.240157,-1.75387,1.00209,-3.14468,-2.109,2.90991,-2.77687,0,-3.43436,-7.16487,-0.478035,0.0496829,-5.73638,0.153456,-6.49524,-3.10499,-3.10235,-2.57554,-3.28959,-2.87672,-2.9996,-1.24251,-3.86527,-2.76578,-5.59101,-2.80903},


    {19.5344,23.5009,28.7259,30.4267,29.5814,25.6263,28.5173,33.9346,33.1428,26.6786,29.5763,30.5868,28.8962,28.2217,30.7955,35.8674,27.4783,27.6898,29.0757,34.524,36.443,35.5957,34.5448,29.3694,28.2268,36.6859,32.9156,32.4806,33.0393,34.282,31.0917,36.2713,32.933,32.8057,33.1327,30.5855,31.3621,34.7481,35.9816,37.8515,33.6212,30.8621,37.2114,30.56,32.1492,29.0024,25.8583,32.3421,35.669,31.9633,30.0272,34.3254,30.0504,29.6665,26.1978,34.1126,27.0263,30.2047,32.6223,31.7532,26.6072,29.4284,29.4404,28.5429},
    {26.2458,28.1438,32.3487,26.0077,30.2055,22.0384,31.6973,31.8601,35.4982,31.8751,28.4664,32.4882,29.8789,27.7616,34.3794,38.5565,27.2352,29.9339,36.0846,36.4192,37.2419,38.8164,37.5122,33.1694,37.5718,32.8593,35.8558,36.2497,35.7717,37.8636,33.0774,33.2697,35.8436,38.5924,35.0765,33.3823,33.9923,39.9687,35.2885,34.8344,30.9557,38.3992,37.2696,42.4733,33.6052,31.3195,37.4201,38.8767,39.1429,33.1945,28.6494,33.7184,31.5391,36.8335,28.2995,32.9384,36.6716,32.8303,32.0131,34.4945,31.7096,29.4409,25.9191,30.438},

    {0,13.8179,15.2989,15.6887,16.3895,0,15.1789,0,0,16.5863,17.2624,17.5865,0,15.4126,25.1348,19.8149,0,20.6746,0,18.895,17.9282,22.0939,25.889,0,0,17.2856,22.9404,0,0,18.5707,0,15.3344,16.959,0,14.3712,16.8467,19.0601,0,16.7326,0,0,0,0,10.9743,0,0,16.7838,17.1095,10.9512,15.4993,14.8628,16.234,15.4665,14.6664,10.1492,10.6956,0,0,0,0,0,0,0,8.50726},
{-3.05486,3.09181,1.90783,1.96303,1.08139,1.26714,2.45066,-1.29998,3.24092,3.43964,0.729198,2.63908,2.08554,1.61817,2.22974,0.518716,4.0621,4.24203,5.99025,-2.84103,8.31151,3.77233,2.72629,4.39469,0.161126,3.44318,4.84878,4.42948,2.09367,0.78795,11.2657,5.34884,2.15595,4.20442,11.605,6.22537,4.36686,6.15323,5.36206,2.19803,4.83863,3.84889,5.15013,6.276,3.28415,13.1089,7.15142,6.13623,6.43391,9.22648,5.07422,8.54753,4.34356,7.92253,5.49653,3.48886,5.91301,8.63055,7.06233,4.8923,5.73601,3.72451,6.98477,1.91689}


};


std::vector<std::vector<double>> vSlopeCorrection = {
    {0.882178,0.877065,0.88691,0.879364,0.871522,0.872309,0.864034,0.892373,0.886528,0.881655,0.886388,0.903898,0.912186,0.915784,0.907696,0.877772,0.895327,0.906099,0.877213,0.872476,0.881789,0.936693,0.891157,0.924288,0.897853,0.905045,0.901262,0.990234,0.884114,0.974318,0.951843,0.95744,0.923614,0.96205,0.894396,0.886016,0.857959,0.87388,0.90257,0.978531,0.883764,0.890932,0.967061,0.881393,0.883242,0.927551,0.966526,0.888758,0.867336,0.885489,0.878346,0.888384,0.930988,0.862677,0.925867,0.882684,0.917383,0.871321,0.8715,0.874985,0.865639,0.867342,0.931606,0.892778},
    {0.858167,0.858684,0.863069,0.862658,0.871737,0.872881,0.875995,0.86212,0.893342,0.864711,0.927789,0.912191,0.848613,0.890152,0.862641,0.867516,0.900773,0.880256,0.877243,0.867599,0.910188,0.871559,0.887999,0.919779,0.881156,0.909388,0.925048,0.922528,0.904975,0.904979,0.929493,1.00883,0.897809,0.920056,0.886261,0.916936,0.879937,0.885848,0.97882,0.973702,0.928025,0.908337,0.910636,0.944206,0.854278,0.881753,0.883083,0.865257,0.863572,0.919713,0.921914,0.901363,0.935138,0.880096,0.890781,0.947956,0.927028,0.960221,0.907397,0.90313,0.879192,0.900715,0.847762,0.902821},

    {1.01359,1.00207,1.02708,1.02068,1.0128,0.994167,1.02378,1.02287,1.01245,1.06242,1.02822,1.01908,1.0174,1.02176,1.02256,0.99095,1.04282,1.01354,1.01212,1.00811,1.00777,1.01806,1.03029,1.02059,1.01336,1.00256,1.01594,1.00891,0.994109,1.03446,1.00851,1.01793,1.00188,1.00375,1.02073,0.990454,1.02725,1.02543,1.07638,0.986875,1.04591,1.03743,0.993798,1.00248,1.01039,0.977196,0.997321,0.960818,0.97408,0.995424,1.07517,0.994359,0.980451,1.00378,1.0088,1.02779,0.970537,1.00163,0.973203,0.998444,1.00196,1.00248,0.987866,1.01253},
    {1.03671,0.998192,1.05089,0.998221,0.989597,1.00879,1.00567,0.987994,1.00827,0.936446,1.03153,1.01615,1.00191,1.01253,0.973281,0.96867,0.991836,0.988259,1.00602,0.969439,1.02056,0.968561,1.01434,0.992236,1.0057,0.969155,1.02245,0.9871,0.98429,0.93515,1.02743,1.02057,0.974529,1.00899,1.00082,1.0025,0.980726,0.990816,0.981334,0.997607,0.982744,0.9832,1.01475,0.926883,1.00125,1,1.00772,0.978305,1.01628,1.00135,0.991196,0.995194,0.973596,0.990622,1.00102,1.00376,1.00545,1.01458,1.00294,0.989549,0.993935,0.973796,0.973586,1.01481},

    {0.844021,0.880675,0.916116,0.884671,0.916327,0.908722,0.920638,0.953333,0.945642,0.906772,0.919983,0.921008,0.919638,0.91409,0.928756,0.95713,0.932408,0.93297,0.92192,0.948711,0.945516,0.956405,0.942028,0.929951,0.94045,0.956151,0.922108,0.958602,0.934286,0.93157,0.949329,0.953204,0.94056,0.944351,0.94547,0.945316,0.932505,0.947212,0.970063,0.957101,0.943886,0.957273,0.95916,0.939643,0.969797,0.913936,0.920936,0.949121,0.974966,0.956815,0.945086,0.954219,0.937041,0.943518,0.917848,0.972137,0.921415,0.930305,0.950842,0.961063,0.921539,0.906964,0.910182,0.937236},
    {0.871635,0.906494,0.91644,0.87303,0.917774,0.880746,0.908875,0.923114,0.936064,0.947721,0.906162,0.946819,0.91008,0.910858,0.938582,0.966333,0.916147,0.931604,0.955694,0.954302,0.944185,0.965473,0.96255,0.958414,0.989849,0.947887,0.951996,0.998586,0.960686,0.983821,0.960709,0.964309,0.974595,0.95862,0.973095,0.946644,0.96789,0.970509,0.959256,0.974993,0.957818,0.998142,0.957914,0.994886,0.957688,0.932003,0.99017,0.976647,0.975114,0.957808,0.919969,0.95626,0.941895,0.977661,0.92815,0.952323,0.95744,0.957288,0.935382,0.946912,0.956899,0.925876,0.916499,0.936706},

    {1,0.883806,0.879304,0.868758,0.853083,1,0.868863,1,1,0.90212,0.854511,0.867894,1,0.867762,0.87294,0.85261,1,0.880776,1,0.876989,0.864178,0.877064,0.867281,1,1,0.880356,0.893501,1,1,0.925157,1,0.904452,0.883651,1,0.903675,0.879859,0.883204,1,0.903235,1,1,1,1,0.910358,1,1,0.87371,0.871358,0.900191,0.879128,0.880522,0.863739,0.875512,0.850005,0.882313,0.879029,1,1,1,1,1,1,1,0.879211},

    {0.985333,0.923253,0.948452,0.940602,0.943693,0.962867,0.931325,0.969404,0.927643,0.91742,0.974321,0.925086,0.930711,0.944737,0.951428,0.995967,0.917155,0.918675,0.892921,1.00143,0.877563,0.93022,0.923702,0.922981,1.00498,0.933797,0.939611,0.926059,0.925762,0.988475,0.881185,0.89629,0.967391,0.907943,0.864849,0.896704,0.922226,0.899169,0.885414,0.948576,0.934598,0.913258,0.908576,0.905998,0.928874,0.8792,0.888071,0.897673,0.931439,0.878341,0.911587,0.905926,0.914197,0.880228,0.903972,0.920204,0.913916,0.87986,0.893949,0.914092,0.893951,0.924801,0.899106,0.937413}

};

std::vector<std::vector<double>> vOffsetCorrection = {
    {-41.4303,-37.7749,-36.9591,-36.1229,-36.573,-35.9322,-37.0151,-36.3192,-36.0362,-35.1325,-36.4007,-36.6067,-35.2303,-37.0761,-35.822,-33.8941,-35.3275,-35.0075,-36.3725,-34.7081,-34.0539,-40.4671,-35.1539,-38.4252,-37.4939,-37.4703,-37.1756,-43.1352,-36.5061,-43.8402,-42.5559,-40.1192,-39.3642,-41.5703,-40.44,-40.3051,-32.9172,-37.9348,-36.1128,-41.9582,-37.8959,-37.7532,-41.8435,-37.8729,-37.5628,-40.4866,-40.3978,-44.0771,-39.3153,-39.1119,-36.725,-40.2196,-40.2018,-38.4948,-41.663,-37.2987,-40.9012,-36.852,-37.1686,-39.1404,-38.9525,-39.7377,-42.1395,-40.4038},
    {-31.9083,-33.2671,-34.8843,-32.2479,-33.0987,-32.0002,-32.5267,-32.7799,-34.5387,-31.6815,-33.4646,-34.9263,-30.334,-30.6888,-32.7153,-30.3181,-33.0439,-35.2162,-33.1843,-32.5342,-33.5968,-33.5563,-30.7664,-35.7647,-35.5532,-32.6658,-34.6962,-35.5291,-36.8415,-33.9473,-34.9894,-40.4502,-36.6168,-34.5022,-34.9231,-33.8186,-36.2884,-35.3187,-39.1178,-39.9579,-35.4292,-35.7479,-36.24,-36.6086,-37.1472,-35.716,-35.9295,-35.067,-34.7944,-37.3976,-36.0801,-38.4832,-39.5492,-34.9236,-33.4512,-37.3728,-39.016,-39.8685,-38.0405,-36.9486,-34.0077,-38.4227,-32.845,-38.4421},
    {-28.2118,-31.2017,-28.1924,-27.7036,-30.2482,-27.2363,-27.9817,-30.1155,-28.3178,-25.8723,-30.8252,-29.4521,-24.4256,-26.6386,-27.4537,-22.2014,-30.4013,-30.0513,-24.5916,-28.2363,-29.1803,-27.5542,-25.0207,-26.7917,-30.2286,-27.6756,-26.7224,-29.7308,-28.0485,-30.4936,-23.703,-32.809,-31.6214,-31.4356,-32.5335,-32.3407,-29.8131,-30.5526,-42.0303,-33.2487,-35.9187,-33.1315,-31.2839,-33.5379,-30.1012,-33.0548,-31.8859,-34.8066,-32.8562,-36.512,-39.7582,-31.1296,-33.2073,-31.3755,-33.6569,-35.0801,-31.4695,-32.8359,-31.4482,-33.4609,-31.975,-35.5505,-33.4752,-36.9615},
    {-27.0292,-27.3011,-25.1665,-27.1646,-23.7669,-23.67,-26.4018,-22.471,-27.2056,-20.0312,-23.9063,-24.5998,-25.1722,-25.6747,-22.6057,-24.5666,-28.2177,-23.7026,-25.6532,-23.5265,-25.2784,-27.0019,-25.8596,-23.4264,-27.4781,-24.5336,-25.4148,-22.6502,-24.3717,-24.1616,-26.8488,-23.8664,-21.9013,-24.6573,-25.0554,-27.0516,-27.6476,-27.2952,-24.1752,-26.5468,-23.0651,-27.3163,-25.8819,-22.4754,-26.8201,0,-27.6098,-29.1256,-24.3541,-24.4146,-28.5058,-24.4483,-30.0787,-27.2876,-26.7348,-25.3679,-26.322,-24.9495,-24.7102,-24.0986,-27.1993,-27.618,-27.2261,-25.1303},
    {-20.6114,-18.8625,-16.4932,-12.323,-16.1037,-18.74,-16.6221,-14.0422,-14.6676,-17.4253,-15.695,-15.2076,-16.3239,-17.572,-15.5838,-12.3368,-18.3503,-18.3708,-16.4859,-12.7596,-9.76442,-12.9031,-12.4898,-16.8375,-17.8948,-12.0158,-13.8743,-15.8044,-13.6476,-11.3077,-16.0734,-10.2713,-15.2285,-15.2035,-13.9331,-16.3594,-15.4034,-12.5802,-13.0656,-10.6222,-13.3311,-16.3928,-11.4165,-16.0947,-16.2694,-15.6154,-18.2698,-15.3388,-12.9956,-15.6345,-16.1021,-12.8058,-15.7151,-16.3295,-17.6837,-15.2287,-17.7485,-15.3492,-15.8172,-15.2959,-17.1705,-15.2093,-14.6517,-16.0751},
    {-14.813,-17.4853,-12.1779,-15.7425,-14.6794,-19.7428,-11.2956,-14.3173,-10.255,-15.0949,-16.4605,-14.8393,-14.9514,-16.3031,-12.5589,-9.45439,-16.895,-15.976,-11.5189,-11.3434,-8.77079,-8.67051,-10.043,-15.6377,-12.9669,-14.8187,-10.7734,-14.653,-12.0164,-12.0312,-15.6499,-15.5671,-15.433,-7.90057,-15.9093,-14.4562,-14.737,-7.49769,-12.3611,-14.6546,-16.2354,-11.9783,-9.39188,-6.01899,-15.5965,-14.6698,-13.3003,-8.48142,-8.98477,-14.8663,-15.6802,-12.8316,-15.0121,-11.4824,-16.3691,-14.3065,-8.68077,-14.2509,-12.9456,-10.9004,-14.8982,-15.0735,-16.9038,-14.9116},
    {0,-13.6851,-12.2254,-11.6173,-12.0486,0,-11.8753,0,0,-10.761,-11.1036,-12.5646,0,-13.1715,-5.00106,-8.27592,0,-13.2822,0,-12.6977,-11.6628,-9.28044,-5.35855,0,0,-12.5253,-8.41942,0,0,-16.6696,0,-15.1525,-14.1982,0,-13.7203,-15.3262,-12.3326,0,-13.0694,0,0,0,0,-16.6695,0,0,-13.4144,-15.2772,-18.2138,-17.0886,-16.3079,-14.5284,-15.8709,-17.4731,-15.7485,-18.2337,0,0,0,0,0,0,0,-17.4575},
    {-27.7688,-22.9201,-22.8282,-23.4916,-24.3517,-24.2784,-22.772,-27.3757,-23.2218,-22.3585,-24.265,-24.3437,-24.2142,-24.6865,-23.6042,-24.2348,-23.558,-21.1452,-19.9418,-27.0803,-19.7907,-21.6136,-25.6235,-22.7376,-26.3122,-24.4527,-20.6589,-21.4688,-26.5228,-26.4174,-18.4115,-21.3641,-25.0206,-22.1698,-19.6333,-23.6559,-21.7862,-21.0069,-22.1875,-24.4882,-21.5336,-24.0383,-21.1907,-20.2154,-21.9297,-16.7906,-20.571,-19.7936,-19.3368,-18.1966,-20.9666,-18.5817,-21.4896,-18.3134,-21.0653,-21.4427,-18.9085,-17.3579,-18.48,-19.5748,-18.9974,-20.3687,-17.6504,-22.3978}
};


    std::vector<std::vector<double>> vSlopeCorrection = {
    {0.965506,0.987885,0.98597,0.993279,0.9881,0.993238,0.989029,0.988835,0.989414,0.990491,0.987958,0.994217,0.98988,0.981744,0.992152,0.999695,0.989954,0.989735,0.991575,1.00425,1.01039,0.960774,0.991837,0.976392,0.983261,0.984661,0.984413,0.957221,0.99281,0.94731,0.968356,0.974003,0.985574,0.960532,0.986824,1.00679,1.00197,0.997258,0.99316,0.950219,0.992384,0.973065,0.958606,0.98731,1.00516,0.972333,0.964591,0.968312,0.999162,0.991177,0.99681,0.986457,0.976891,0.999437,0.965597,0.984145,0.971544,1.00178,1.00585,0.993351,1.00258,1.00787,0.962445,0.981752},
    {1.00638,1.00475,1.00592,1.00794,1.00294,1.09146,0.996975,1.0035,0.998224,1.00791,0.990954,0.994776,1.00688,1.00297,1.00827,0.999893,0.997504,0.998928,1.00023,1.00335,0.987788,1.00661,1.00018,0.981948,0.994115,0.99124,0.992832,0.982406,0.984153,0.999777,0.988512,0.960417,0.994825,0.99951,0.998039,0.988355,1.00016,0.999882,0.968178,0.970778,0.982373,0.986131,0.998584,0.985302,1.01332,0.991936,1.00536,1.01195,1.00814,0.981298,0.990124,0.989283,0.980737,1.00479,0.998605,0.977007,0.966392,0.984737,0.983767,0.991802,1.01089,0.993029,1.01076,0.978671},
    {1.00445,1.00624,1.00434,1.00582,0.998768,1.00261,1.00833,0.999305,1.00687,1.00765,1.00725,1.00499,1.00714,1.0065,1.00609,1.01952,1.00509,1.00005,1.02026,1.00956,1.00075,1.021,1.01496,1.0025,1.00568,1.01562,1.00136,1.00201,1.01739,0.99901,1.01358,0.997801,1.00326,1.01528,1.00143,1.00872,0.999714,1.01318,0.96701,1.01064,0.989695,0.99697,1.02286,1.00933,1.01349,1.01864,1.02853,1.01292,1.02097,0.995148,1.08109,1.02015,1.00962,1.00449,1.00234,0.978434,1.02449,1.00255,1.06057,1.00218,1.00553,1.00083,1.00562,0.994892},
    {1.01531,1.00279,1.02457,1.01428,1.01343,1.00849,1.00911,1.01894,1.00622,1.02362,1.00995,1.01288,1.01018,1.02201,1.0105,1.02674,1.00841,1.02096,1.02388,1.03219,1.01947,1.01402,1.0063,1.01781,1.01817,1.02842,1.0204,1.02912,1.01226,1.01222,1.01105,1.0185,1.02407,1.02285,1.03465,1.01061,1.01732,1.02513,1.03258,1.0096,1.02797,1.02059,1.01353,1.04382,1.00162,1,1.01985,1.00944,1.02247,1.02973,1.0142,1.02514,1.00652,1.02455,1.01683,1.0152,1.01066,1.02433,1.04704,1.0417,1.01824,1.01358,1.00732,1.01257},
    {1.00528,1.00222,1.00948,1.0444,1.01427,1.00176,1.00808,1.0196,1.01438,0.986417,0.998689,0.996697,1.00336,0.99874,0.998951,1.00541,0.995612,0.997828,1.00697,0.996196,1.04131,0.990166,1.00206,0.986567,0.995869,0.995185,0.983973,0.982708,0.994651,0.995507,0.984043,1.00314,0.99361,0.979034,0.997431,0.986599,0.987459,0.990357,0.994163,0.994756,0.989186,0.991953,0.994595,0.986141,0.982004,0.984272,0.997211,0.974699,0.984062,0.971621,0.987456,0.996336,0.98115,0.993267,0.994924,0.991238,0.995741,0.981168,0.982958,0.983523,0.997391,1.00799,1.02169,0.981607},
    {1.0279,1.02994,1.03352,1.01288,1.01845,1.007,1.02586,1.02571,1.05153,0.985311,1.0245,0.999638,1.00878,0.995262,0.992174,1.00146,0.994243,0.980922,1.00742,1.00752,1.03836,1.01873,1.02911,0.986019,1.00943,0.985075,1.0108,0.980203,0.999362,1.0033,0.973902,0.974438,0.983382,1.00557,0.981058,0.995526,0.984874,1.02568,0.992245,0.979531,0.982306,0.998244,0.998547,1.03694,0.986808,0.984275,0.983614,1.00548,1.00465,0.986933,0.973432,0.979994,0.983059,0.998264,0.994027,0.992206,1.01043,0.981606,0.981863,0.9994,0.982694,0.989499,0.992512,0.986523},
    {1,1.03148,1.0599,1.07529,1.06658,1,1.0545,1,1,0.995376,1.05525,1.02247,1,1.01587,1.06725,1.08253,1,1.01571,1,1.01862,1.03276,1.01024,1.07491,1,1,1.00103,1.0269,1,1,0.976804,1,0.997719,1.00862,1,1.00016,1.0006,1.01457,1,0.985236,1,1,1,1,0.992482,1,1,1.01266,1.00353,1.00295,0.9979,1.00753,1.04248,1.02906,1.03399,0.990683,1.01232,1,1,1,1,1,1,1,1.02533},
    {1.01321,1.03554,1.02963,1.02432,1.0289,1.01566,1.02372,1.02744,1.01687,1.01019,1.01361,1.01291,1.01663,1.011,1.00849,1.00777,1.00971,1.02055,1.02204,1.01174,1.01795,1.00896,1.01143,1.00847,1.00084,1.00552,0.993629,1.00796,1.01251,0.999731,1.00538,1.01365,1.00365,1.01099,1.01893,1.01518,1.00888,1.00639,1.03093,1.00542,1.006,1.01083,1.00616,1.00064,1.0128,1.01137,1.00462,1.00399,1.00111,1.00777,1.00193,1.00233,1.01421,1.02513,1.00641,1.01342,1.00644,1.02798,1.02293,1.01541,1.01866,1.01854,1.03636,1.02262}
};

*/


    void write()
{
    std::random_device rd;  //Will be used to obtain a seed for the random number engine
    std::mt19937 gen(rd()); //Standard mersenne_twister_engine seeded with rd()
    std::uniform_real_distribution<> dis(0.8, 1.2);


    std::cout << "XXXXXXXXXXXXXXXXXXXXXXX" << std::endl;

    QJsonObject globalObject;
    QJsonArray calibrationArray;



    int theFec = 2;
    for(int fec =2; fec < 3; fec++){

        for(int vmm =0; vmm < 8; vmm++){
            QJsonObject calibrationObject;
            QJsonArray adcOffsetArray;
            QJsonArray adcSlopeArray;
            QJsonArray timeOffsetArray;
            QJsonArray timeSlopeArray;
            for(int ch = 0; ch<64; ch++){

                std::vector<double> x;
                std::vector<double> y;
                double adcSlope=1, adcOffset=0;
                double timeSlope=1, timeOffset=0;

                adcOffsetArray.push_back(vADCOffsetCorrection[ch]);
                adcSlopeArray.push_back(vADCSlopeCorrection[ch]);
                timeOffsetArray.push_back(vOffsetCorrection[vmm][ch]);
                timeSlopeArray.push_back(vSlopeCorrection[vmm][ch]);

            }

            calibrationObject.insert("fecID",theFec);
            calibrationObject.insert("vmmID",vVMM[vmm]);
            calibrationObject.insert("adc_offsets",adcOffsetArray);
            calibrationObject.insert("adc_slopes",adcSlopeArray);
            calibrationObject.insert("time_offsets",timeOffsetArray);
            calibrationObject.insert("time_slopes",timeSlopeArray);
            calibrationArray.push_back(calibrationObject);


        }
    }
    globalObject.insert("vmm_calibration",calibrationArray);



    QJsonDocument doc(globalObject);
    QString pwd("");
    char * PWD;
    PWD = getenv ("PWD");
    pwd.append(PWD);
    QFile jsonFile("./calibration.json");
    jsonFile.open(QFile::WriteOnly);
    jsonFile.write(doc.toJson(QJsonDocument::Compact));


    std::cout << "Wrote File " << pwd.toStdString() << std::endl;

}

void read()
{

    std::string jsonfile = "./calibration.json";
    std::ifstream t(jsonfile);
    std::string jsonstring((std::istreambuf_iterator<char>(t)),
                           std::istreambuf_iterator<char>());
    if (!t.good()) {
        std::cout << "Invalid Json file: {}" <<  jsonfile << std::endl;

        throw std::runtime_error("CalibrationFile error - requested file unavailable.");
    }


    nlohmann::json Root;
    try {
        Root = nlohmann::json::parse(jsonstring);
    } catch (...) {
        std::cout << "Invalid Json: {}" << jsonstring << std::endl;
        throw std::runtime_error("Invalid Json in calibration file.");
    }

    try {

        auto theAdcCals = Root["vmm_calibration"];
        for (auto &cal : theAdcCals) {
            auto fecid = cal["fecID"].get<size_t>();
            auto vmmid = cal["vmmID"].get<size_t>();
            auto adc_offsets = cal["adc_offsets"];
            auto adc_slopes = cal["adc_slopes"];
            auto time_offsets = cal["time_offsets"];
            auto time_slopes = cal["time_slopes"];

            std::cout << "fecid: " << (int)fecid << ", vmmid: " << (int)vmmid
                      << ", adc_offsets:" <<  (int)adc_offsets.size() << ", adc_slopes:" <<  (int)adc_slopes.size()
                      << ", time_offsets:" <<  (int)time_offsets.size() << ", time_slopes:" <<  (int)time_slopes.size()
                      << std::endl;


            for (size_t j = 0; j < adc_offsets.size(); j++) {
                std::cout << "\t\t\t\t\t ADC " << adc_offsets[j].get<float>() << " " << adc_slopes[j].get<float>() << std::endl;
                std::cout << "\t\t\t\t\t TIME " << time_offsets[j].get<float>() << " " << time_slopes[j].get<float>() << std::endl;
            }

        }


    }
    catch (const std::exception &exc) {
        std::cout << "JSON config - invalid json: {}" <<  exc.what() << std::endl;
        throw std::runtime_error("Invalid json in calibration file field.");
    }

}

void read_qt()
{
    std::cout << "READ QT" << std::endl;
    QFile file;
    file.setFileName("./calibration.json");
    file.open(QIODevice::ReadOnly | QIODevice::Text);
    QString val = file.readAll();
    file.close();
    QJsonDocument doc = QJsonDocument::fromJson(val.toUtf8());

    QJsonObject jsonObject = doc.object();
    QJsonArray jsonArray = jsonObject["vmm_calibration"].toArray();


    foreach (const QJsonValue & value, jsonArray) {
        const auto& obj = value.toObject();
        const auto& keys = obj.keys();
        std::cout << "ARRAY" << std::endl;
        for(const auto& key : keys){
            if(key == "adc_slopes" || key == "adc_offsets" || key == "time_slopes" || key == "time_offsets")
            {
                auto const & adc_slopes = obj[key].toArray();
                for(const auto& v : adc_slopes){
                    std::cout << key.toStdString() << " " << v.toDouble() << std::endl;
                }
            }
            else {
                std::cout << key.toStdString() << " " << obj[key].toInt() << std::endl;
            }

        }
    }

}

void convert(char* name, int ix, int iy)
{
    std::cout << "Convert JSON to ImageJ" << std::endl;
    QFile file;
    QString sName = name;
    file.setFileName(sName);
    file.open(QIODevice::ReadOnly | QIODevice::Text);
    QString val = file.readAll();
    file.close();
    QJsonDocument doc = QJsonDocument::fromJson(val.toUtf8());

    QJsonObject jsonObject = doc.object();
    QJsonArray jsonArray = jsonObject["fArray"].toArray();

    QString filename = sName+"_conv";
    QFile qFile(filename);
    if (qFile.open(QIODevice::ReadWrite)) {
        QTextStream stream(&qFile);
        int xcnt = 0;
        int ycnt = 0;
        int z = 0;
        std::vector<double> vals;
        foreach (const QJsonValue & value, jsonArray) {
            z++;
            vals.push_back(value.toDouble());
        }
        if(ix == 0 || iy == 0) {
            xcnt = qSqrt(z);
            ycnt = qSqrt(z);

        }

        else {
            xcnt = ix + 2;
            ycnt = iy + 2;
        }
        std::cout << "Total pixels " << z << ", image has " << xcnt-2 << " x " << ycnt-2 << " pixels" << std::endl;

         for(int y=1; y < ycnt-1; y++) {
            for(int x=1; x < xcnt-2; x++) {
                stream << vals[y*xcnt+x] << " ";
            }
            stream << vals[y*xcnt+xcnt-2] << "\n";
        }


    }
    qFile.close();



}

int main(int argc, char *argv[])
{

    //write();
    //read();
    //read_qt();
    if(argc == 4) {
        convert(argv[1], atoi(argv[2]), atoi(argv[3]));
    }
    else if(argc == 2) {
        convert(argv[1],0,0);
    }
    else if(argc == 1) {
        write();

    }

    return 0;
}
